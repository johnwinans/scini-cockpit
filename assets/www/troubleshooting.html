<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Troubleshooting</title>
  <link href="default.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="/browserMqtt.js"></script>
  <script type="text/javascript" src="/nav.js"></script>
  <script type="text/javascript" src="/troubleshooting.js"></script>
</head>
<body onload="init()">
  <nav>
    <ul>
      <li><a href="index.html">Camera</a></li>
      <li><a href="controls.html">Controls</a></li>
      <li><a href="telemetry.html">Telemetry</a></li>
      <li><a href="telemetry-brief.html">Telemetry Brief</a></li>
      <li><a href="files.html">Files</a></li>
      <li><a class="active" href="troubleshooting.html">Troubleshooting</a></li>
      <li><a href="video-gl.html">WebGL Camera (Beta)</a></li>
      <li><span class="dot" id="video-211-record"><span class="tooltiptext">211</span></span></li>
      <li><span class="dot" id="video-213-record"><span class="tooltiptext">213</span></span></li>
      <li><span class="dot" id="video-215-record"><span class="tooltiptext">215</span></span></li>
      <li><span class="dot" id="video-217-record"><span class="tooltiptext">217</span></span></li>
      <li><span class="dot" id="video-218-record"><span class="tooltiptext">218</span></span></li>
      <li><div class="clock"></div></li>
    </ul>
  </nav>
  <h1>How to Stop/Start Recording</h1>
  ** This process will be updated as soon as possible **
  <ol>
    <li>Go to the <a href="http://192.168.2.2">OpenROV Cockpit interface</a> - make sure the indicator in the top bar is <b style="color:green;">green</b> not <b style="color:red;">red</b>  - if it's red, find out who still has Cockpit open and follow this process on that computer</li>
    <li>Click the square dot icon in the upper right corner</li>
    <li>In the pop-up menu, click Settings</li>
    <li>Click Video</li>
    <li>Find "RecordOnServer" and set the value to True - if it's already True, video should be recording on the server</li>
  </ol>
  <h1>No video</h1>
  Make sure each step passes before proceeding.
  <ol>
    <li>The video tabs require Chrome v69+.  You have <b id="browser"></b></li>
    <li>Make sure cameras are reachable from the surface.  You should see a single image open in a new tab by clicking the following URLs for each camera.  If one fails, check that camera.  If they all fail, there may be a network connectivity problem with the ROV.</li>
    <ol style="list-style-type: lower-alpha; padding-bottom: 0;">
      <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.211:8081/img">211 Camera</a></li>
      <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.213:8081/img">213 Camera</a></li>
      <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.215:8081/img">215 Camera</a></li>
      <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.217:8081/img">217 Camera</a></li>
      <li style="margin-left:2em; padding-bottom: 0;"><a target="_blank" href="http://192.168.2.218:8081/img">218 Camera</a></li>
    </ol>
    <li>Restart the mjpg_streamer processes by clicking the button.<button id="video-restart">Restart video streamers</button></li>
    <li>Try reducing resolution to 1/4 or 1/2 on problematic cameras from the controls tab.</li>
    <li>Try resetting the camera directly from it's native control page.</li>
  </ol>
  <h1>View Camera Boot Messages</h1>
  This information can be useful in trying to determine the status of USB device connectivity and other potential hardware issues captured by the camera's operating system.
  <ol style="padding-bottom: 0;">
    <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.211/phpshell.php?command=dmesg">211 Camera Dmesg</a></li>
    <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.213/phpshell.php?command=dmesg">213 Camera Dmesg</a></li>
    <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.215/phpshell.php?command=dmesg">215 Camera Dmesg</a></li>
    <li style="margin-left:2em"><a target="_blank" href="http://192.168.2.217/phpshell.php?command=dmesg">217 Camera Dmesg</a></li>
    <li style="margin-left:2em; padding-bottom: 0;"><a target="_blank" href="http://192.168.2.218/phpshell.php?command=dmesg">218 Camera Dmesg</a></li>
  </ol>
  <h1>Add or Remove an RS-485 Master</h1>
  <ol style="padding-bottom: 0;">
    <li style="margin-left:2em"><a target="_blank" href="/files.html">Click to open the Files browser in a new tab</a></li>
    <li style="margin-left:2em">Click assets</li>
    <li style="margin-left:2em">Right-click mqttConfig.json -> Edit</li>
    <li style="margin-left:2em">Click assets</li>
    <li style="margin-left:2em">Find the IP address of the camera you want to designate as a second master</li>
    <li style="margin-left:2em">Change false to true</li>
    <li style="margin-left:2em">Right-click -> Save</li>
    <li style="margin-left:2em">Right-click -> Close</li>
    <li style="margin-left:2em">Stop and start server using icons on server desktop</li>
  </ol>
  <h1>Device Control Failure</h1>
  If you are unable to control a particular device or several devices:
  <ol>
    <li>Make sure that all expected RS485 bus "masters" are set to true or false appropriately in <a style="color:greenyellow;" href="files.html">assets/mqttConfig.json</a>.  If a device is set to false, it will receive no messages to pass onto the serial bus.  If multiple devices attached to the same RS485 bus are set to true, messages may be corrupted upon receipt.  Edit the file to make changes, save it, then stop and start the OpenROV server to make the changes take effect.</li>
  </ol>
</body>
</html>